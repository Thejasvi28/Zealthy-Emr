generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Patient {
  id           String         @id @default(cuid())
  email        String         @unique
  passwordHash String
  firstName    String
  lastName     String
  dob          DateTime?      @db.Timestamp(6)
  phone        String?
  address      String?
  city         String?
  state        String?
  zip          String?
  createdAt    DateTime       @default(now())
  updatedAt    DateTime       @updatedAt
  appointments Appointment[]
  prescriptions Prescription[]
}

model Appointment {
  id             String   @id @default(cuid())
  patient        Patient  @relation(fields: [patientId], references: [id])
  patientId      String
  providerName   String
  startAt        DateTime @db.Timestamp(6)
  repeat         Repeat   @default(NONE)
  repeatInterval Int      @default(1)
  repeatUntil    DateTime? @db.Timestamp(6)
  createdAt      DateTime @default(now())
  updatedAt      DateTime @updatedAt
}

enum Repeat {
  NONE
  DAILY
  WEEKLY
  MONTHLY
}

model Medication {
  id        String         @id @default(cuid())
  name      String         @unique
  dosages   DosageOption[]
  prescriptions Prescription[]
  createdAt DateTime       @default(now())
}

model DosageOption {
  id           String      @id @default(cuid())
  medication   Medication  @relation(fields: [medicationId], references: [id])
  medicationId String
  strength     String
}

model Prescription {
  id              String      @id @default(cuid())
  patient         Patient     @relation(fields: [patientId], references: [id])
  patientId       String
  medication      Medication  @relation(fields: [medicationId], references: [id])
  medicationId    String
  dosage          String
  quantity        Int
  refillDate      DateTime?   @db.Timestamp(6)
  refillSchedule  RefillSchedule @default(NONE)
  createdAt       DateTime @default(now())
  updatedAt       DateTime @updatedAt
}

enum RefillSchedule {
  NONE
  DAILY
  WEEKLY
  MONTHLY
}
